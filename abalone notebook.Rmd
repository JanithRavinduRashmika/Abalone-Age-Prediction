---
title: "R Notebook"
output: html_notebook
---


```{r}
dataSet = abalone
dataSet$Age = dataSet$Rings+1.5


sum(is.null(dataSet))
sum(duplicated(dataSet))

dataSet

```
```{r}
summary(dataSet)

dataSet$Sex = as.factor(dataSet$Sex)
dataSet

```

```{r}
library(ggplot2)
library(cowplot)



a = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Length),fill="#00a86b")+
  labs(title = "Distribution of Length",x = "Length",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))

b = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Diameter),fill="#00a86b")+
  labs(title = "Distribution of Diameter",x = "Diameter",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))

c = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Height),fill="#00a86b")+
  labs(title = "Distribution of Height",x = "Height",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))
c
d = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Whole.weight),fill="#00a86b")+
  labs(title = "Distribution of Whole Weight",x = "Whole Weight",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))

e = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Shucked.weight),fill="#00a86b")+
  labs(title = "Distribution of Shucked Weight",x = "Shucked Weight",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))

f = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Viscera.weight),fill="#00a86b")+
  labs(title = "Distribution of Viscera Weight",x = "Viscera Weight",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))

g = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Shell.weight),fill="#00a86b")+
  labs(title = "Distribution of Shell Weight",x = "Shell Weight",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))


i = ggplot(dataSet)+
  geom_histogram(aes(dataSet$Age),fill="#00a86b")+
  labs(title = "Distribution of Age",x = "Age",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold"))

plot_grid(a,b,c,d,e,f,g,i,nrow = 2)
?plot_grid
```
```{r}
library(e1071)

apply(dataSet[-c(1,9)],2,skewness)

```

```{r}
library(ggplot2)
library(RColorBrewer)
dataSet$Sex = factor(dataSet$Sex,levels = c("M","F","I"))
ggplot(dataSet,aes(dataSet$Sex,fill = dataSet$Sex))+
  geom_bar()+
  scale_fill_manual(values=c("#3288bd","#d53e4f","#abdda4"),name = "Sex",breaks = c("M","F","I") ,labels = c("Male","Female","??"))+
  labs(title = "fsafsdaff",x = "Sex",y = "Frequency")+
  theme(axis.title = element_text(face = "bold"),plot.title = element_text(face = "bold",size = 16))
  scale_color
```

```{r}

library(ggplot2)

length(dataSet$Length)

q1 = quantile(dataSet$Length,0.25)
q3 = quantile(dataSet$Length,0.75)

iqr = q3-q1
lowerBound = q1-1.5*iqr
upperBound = q3+1.5*iqr
outLiers = dataSet$Length[dataSet$Length<q1|dataSet$Length>q3]
outLiers = dataSet$Length
outLiers[!(outLiers<lowerBound | outLiers>upperBound)] = NA



ggplot(dataSet,aes(dataSet$Length))+
  geom_jitter(aes(outLiers,0),color = "red")+
  geom_boxplot(aes(dataSet$Length,0),fill = "#5e4fa2",show.legend = F,outlier.shape = NA)+
  labs(title = "fafdsafd",x = "Length",y = "")
  coord_flip()
  

?geom_boxplot
```


## Bivariate

```{r}
library(GGally)
library(ggplot2)

ggpairs(dataSet,mapping = ggplot2::aes(color = "red"),columns = 2:9,upper = list(continuous = "cor",color = "red"),lower = list(continuous = "points",diag = list(continuous = "densityDiag")))

```

```{r}
library(ggplot2)
library(datarium)
library(reshape)

corMatrix = cor(dataSet[2:9])
meltData = melt(corMatrix)

meltData
ggplot(meltData,aes(meltData$X1,meltData$X2))+
  geom_tile(aes(fill = meltData$value))+
  scale_fill_gradient(high = "#9e0142",low ="#e6f598")


```



